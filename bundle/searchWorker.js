function load(t,e){var a;if("undefined"!=typeof XMLHttpRequest)a=new XMLHttpRequest;else for(var o=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],r=0,s=o.length;r<s;r++)try{a=new ActiveXObject(o[r]);break}catch(t){}a.onreadystatechange=function(){a.readyState<4||200===a.status&&4===a.readyState&&e(a)},a.open("GET",t,!0),a.send("")}var data,lastKeyword,search=function(t){for(var e=[],a=t.toLowerCase().replace(/ /g," "),o=a.split(" "),r=0;r<data.length;r++){for(var s=data[r],n=s.title.toLowerCase(),d=s.preview.toLowerCase(),l=s.content.toLowerCase(),i=!0,c=0;c<o.length;c++){var f=o[c];if(n.indexOf(f)==-1&&d.indexOf(f)==-1&&l.indexOf(f)==-1){i=!1;break}}i&&e.push(s)}postMessage({keyword:a,keywords:o,results:e})};onmessage=function(t){var e=t.data.action;"start"==e?load(t.data.root+"/index.json",function(t){data=JSON.parse(t.responseText.toLowerCase()),lastKeyword&&search(lastKeyword)}):data?search(t.data.keyword):lastKeyword=t.data.keyword};